<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ê°„ ì‹ì‚¬ ë©”ë‰´ ê³µì§€ í”Œë«í¼</title>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --text-color: #333;
            --card-bg: #ffffff;
            --accent: #4a90e2; /* ë©”ì¸ ë¸”ë£¨ */
            --border: #ddd;
            --input-bg: #fff;
            --header-bg: #4a90e2;
            --header-text: #fff;
        }
        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --card-bg: #1e1e1e;
            --accent: #64b5f6;
            --border: #444;
            --input-bg: #333;
            --header-bg: #333;
            --header-text: #64b5f6;
        }
        body { margin: 0; font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; background: var(--bg-color); color: var(--text-color); transition: 0.3s; padding-bottom: 80px; }
        
        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tabs { display: flex; background: var(--card-bg); position: sticky; top: 0; box-shadow: 0 2px 10px rgba(0,0,0,0.05); z-index: 100; }
        .tab-btn { flex: 1; padding: 16px; border: none; background: transparent; color: var(--text-color); font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; font-size: 1rem; transition: 0.2s; }
        .tab-btn.active { border-bottom-color: var(--accent); color: var(--accent); }

        /* ì»¨í…ì¸  ì˜ì—­ */
        .content { padding: 20px; max-width: 1000px; margin: 0 auto; display: none; animation: fadeIn 0.3s; }
        .content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* ì¹´ë“œ UI */
        .card { background: var(--card-bg); border-radius: 16px; padding: 24px; margin-bottom: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid var(--border); }
        .meal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .meal-badge { background: var(--accent); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8em; font-weight: bold; }
        .meal-date { color: var(--accent); font-weight: bold; font-size: 0.9em; }
        .meal-menu { font-size: 1.15em; white-space: pre-wrap; line-height: 1.6; word-break: keep-all; }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .table-container { overflow-x: auto; border-radius: 12px; border: 1px solid var(--border); }
        .menu-table { width: 100%; border-collapse: collapse; font-size: 0.9em; min-width: 800px; table-layout: fixed; }
        .menu-table th, .menu-table td { border: 1px solid var(--border); padding: 10px; text-align: center; vertical-align: middle; white-space: pre-wrap; background: var(--card-bg); }
        .menu-table th { background: var(--header-bg); color: var(--header-text); width: 80px; font-weight: 600; }

        /* ì…ë ¥ ê·¸ë¦¬ë“œ & ë„êµ¬ */
        .smart-tools { background: var(--card-bg); padding: 20px; border-radius: 12px; border: 1px solid var(--accent); margin-bottom: 24px; }
        .tool-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; flex-wrap: wrap; }
        .smart-paste-area { width: 100%; height: 100px; padding: 12px; border: 1px solid var(--border); border-radius: 8px; box-sizing: border-box; font-size: 0.9em; background: var(--input-bg); color: var(--text-color); resize: vertical; }
        
        /* ê·¸ë¦¬ë“œ ì¸í’‹ */
        .input-grid th { background: #eee; color: #333; }
        [data-theme="dark"] .input-grid th { background: #444; color: #fff; }
        .cell-input { 
            width: 100%; height: 100%; border: none; outline: none; padding: 8px; box-sizing: border-box; 
            background: var(--input-bg); color: var(--text-color); font-family: inherit; resize: none; display: block; 
            text-align: center; font-size: 0.9em;
        }
        textarea.cell-input { min-height: 100px; text-align: left; }
        .cell-input:focus { background: rgba(74, 144, 226, 0.1); }

        /* ë²„íŠ¼ */
        button.action-btn { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 1.1em; font-weight: bold; margin-top: 10px; transition: 0.2s; }
        button.action-btn:hover { opacity: 0.9; transform: scale(0.99); }
        button.small-btn { padding: 8px 16px; background: var(--accent); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9em; }

        /* ê¸°íƒ€ */
        .theme-toggle { position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; background: var(--card-bg); border: 1px solid var(--border); border-radius: 50%; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-size: 1.5em; display: flex; align-items: center; justify-content: center; z-index: 200; }
        .loading { text-align: center; padding: 40px; color: gray; }
        input[type="date"], input[type="password"] { padding: 8px; border-radius: 4px; border: 1px solid var(--border); background: var(--input-bg); color: var(--text-color); }
    </style>
</head>
<body>

<div class="tabs">
    <button class="tab-btn active" onclick="switchTab('next-meal')">ë‹¤ìŒ ì‹ì‚¬</button>
    <button class="tab-btn" onclick="switchTab('weekly')">ì£¼ê°„ ë©”ë‰´</button>
    <button class="tab-btn" onclick="switchTab('upload')">ê´€ë¦¬ì</button>
</div>

<div id="next-meal" class="content active">
    <div id="next-meal-container">
        <div class="loading">â³ ì‹ì‚¬ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
    </div>
</div>

<div id="weekly" class="content">
    <div class="table-container">
        <table class="menu-table" id="weekly-table"></table>
    </div>
</div>

<div id="upload" class="content">
    <div id="login-section" class="card" style="max-width:400px; margin:50px auto; text-align:center;">
        <h3 style="margin-top:0;">ê´€ë¦¬ì ë¡œê·¸ì¸</h3>
        <p style="font-size:0.9em; color:gray;">ë©”ë‰´ë¥¼ ì—…ë¡œë“œí•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
        <input type="password" id="admin-pw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" style="width:100%; box-sizing:border-box; padding:12px; margin-bottom:10px;">
        <button class="action-btn" onclick="showUploadForm()">ë¡œê·¸ì¸</button>
    </div>

    <div id="upload-form" style="display:none;">
        <h2 style="color:var(--accent);">ğŸ“‹ ì£¼ê°„ ë©”ë‰´ ì‘ì„±</h2>

        <div class="smart-tools">
            <h4 style="margin-top:0;">ğŸ“… ë‚ ì§œ ìë™ ì±„ìš°ê¸°</h4>
            <div class="tool-row">
                <span>ì‹œì‘ì¼(í† ìš”ì¼) ì„ íƒ:</span>
                <input type="date" id="start-date-picker">
                <button class="small-btn" onclick="autoFillDates()">ì ìš©í•˜ê¸°</button>
            </div>
            <p style="font-size:0.8em; color:gray; margin:0;">* ë‚ ì§œë¥¼ ì„ íƒí•˜ë©´ í‘œì˜ ë‚ ì§œ ì¹¸ì´ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.</p>
        </div>

        <div class="smart-tools">
            <h4 style="margin-top:0;">âš¡ ì—‘ì…€ ë¶™ì—¬ë„£ê¸° (ìŠ¤ë§ˆíŠ¸)</h4>
            <p style="font-size:0.9em; margin-bottom:8px;">ì—‘ì…€ì—ì„œ <strong>[ì¡°ì‹/ì¤‘ì‹/ì„ì‹] x [7ì¼] (3í–‰ 7ì—´)</strong> ë²”ìœ„ë§Œ ë³µì‚¬í•´ì„œ ì•„ë˜ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
            <textarea id="smart-paste-area" class="smart-paste-area" placeholder="ì—¬ê¸°ì— Ctrl+V í•˜ì„¸ìš”..."></textarea>
            <button class="small-btn" onclick="applySmartPaste()" style="margin-top:8px; width:100%;">í‘œì— ë‚´ìš© ì ìš©í•˜ê¸°</button>
        </div>

        <div class="table-container">
            <table class="menu-table input-grid" id="edit-table">
                <tr id="row-date">
                    <th>ë‚ ì§œ</th>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                    <td><input class="cell-input date-cell" placeholder="00ì›”00ì¼"></td>
                </tr>
                <tr>
                    <th>ìš”ì¼</th>
                    <td><input class="cell-input" value="í† " readonly style="background:#eee; font-weight:bold;"></td>
                    <td><input class="cell-input" value="ì¼" readonly style="background:#eee; font-weight:bold;"></td>
                    <td><input class="cell-input" value="ì›”" readonly style="background:#eee; font-weight:bold;"></td>
                    <td><input class="cell-input" value="í™”" readonly style="background:#eee; font-weight:bold;"></td>
                    <td><input class="cell-input" value="ìˆ˜" readonly style="background:#eee; font-weight:bold;"></td>
                    <td><input class="cell-input" value="ëª©" readonly style="background:#eee; font-weight:bold;"></td>
                    <td><input class="cell-input" value="ê¸ˆ" readonly style="background:#eee; font-weight:bold;"></td>
                </tr>
                <tr id="row-bf">
                    <th>ì¡°ì‹</th>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                </tr>
                <tr id="row-lh">
                    <th>ì¤‘ì‹</th>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                </tr>
                <tr id="row-dn">
                    <th>ì„ì‹</th>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                    <td><textarea class="cell-input meal-cell"></textarea></td>
                </tr>
            </table>
        </div>

        <button class="action-btn" onclick="uploadMenuData()">ğŸš€ ì„œë²„ì— ì €ì¥í•˜ê¸°</button>
    </div>
</div>

<button class="theme-toggle" onclick="toggleTheme()" title="ë‹¤í¬ëª¨ë“œ ì „í™˜">ğŸŒ“</button>

<script>
    // â–¼â–¼â–¼ ì—¬ê¸°ì— ë°˜ë“œì‹œ [ìƒˆ ë°°í¬] í›„ ì–»ì€ URLì„ ë„£ìœ¼ì„¸ìš” â–¼â–¼â–¼
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxRVKkLZ5vkaKqfZiuPdgYCfKKAbjHht_WcfnHA-DCG-2KGDeTvxlrxSpiHrnoJfzYgyA/exec'; 

    let globalMenuData = null;

    document.addEventListener('DOMContentLoaded', () => {
        fetchData();
        applyTheme();
    });

    // --- 1. ë°ì´í„° ì¡°íšŒ ---
    function fetchData() {
        fetch(SCRIPT_URL)
            .then(res => res.json())
            .then(data => {
                globalMenuData = data.menu;
                if(globalMenuData && globalMenuData.length > 0) {
                    renderNextMeal();
                    renderWeeklyTable();
                } else {
                    document.getElementById('next-meal-container').innerHTML = '<div class="card" style="text-align:center;">ë“±ë¡ëœ ë©”ë‰´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                }
            })
            .catch(err => {
                console.error(err);
                document.getElementById('next-meal-container').innerHTML = '<div class="card" style="text-align:center; color:red;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</div>';
            });
    }

    // --- 2. ë Œë”ë§ ë¡œì§ ---
    function renderNextMeal() {
        const now = new Date();
        const hour = now.getHours();
        const day = now.getDay(); // 0(ì¼)~6(í† )
        
        // ë°ì´í„° ì¸ë±ìŠ¤ ë§¤í•‘: í† (6)->1, ì¼(0)->2, ì›”(1)->3 ...
        let colIdx = day === 6 ? 1 : day + 2;
        if (colIdx > 7) colIdx = 2; // ì¼ìš”ì¼ ë³´ì •

        // ì‹œê°„ëŒ€ë³„ ë¡œì§ (0:ì¡°ì‹ì „, 1:ì¡°ì‹ì¤‘, 2:ì¤‘ì‹ì „, 3:ì¤‘ì‹ì¤‘, 4:ì„ì‹ì „, 5:ì„ì‹ì¤‘, 6:ì„ì‹í›„)
        let timeState = 6;
        if (hour < 5) timeState = 0;
        else if (hour < 6) timeState = 1;
        else if (hour < 12) timeState = 2;
        else if (hour < 13) timeState = 3;
        else if (hour < 18) timeState = 4;
        else if (hour < 20) timeState = 5;

        const container = document.getElementById('next-meal-container');
        container.innerHTML = '';

        // í‘œì‹œí•  ì‹ì‚¬ ê³„ì‚°
        let targets = []; // {col, row, label}
        
        // í˜„ì¬/ë‹¤ìŒ ì‹ì‚¬ ê²°ì • ë¡œì§
        if (timeState <= 1) { // ì¡°ì‹ íƒ€ì„
            targets.push({c: colIdx, r: 2, l: timeState===1 ? "ì§„í–‰ ì¤‘ì¸ ì‹ì‚¬ (ì¡°ì‹)" : "ê³§ ë‹¤ê°€ì˜¤ëŠ” ì‹ì‚¬ (ì¡°ì‹)"});
            targets.push({c: colIdx, r: 3, l: "ë‹¤ìŒ ì‹ì‚¬ (ì¤‘ì‹)"});
        } else if (timeState <= 3) { // ì¤‘ì‹ íƒ€ì„
            targets.push({c: colIdx, r: 3, l: timeState===3 ? "ì§„í–‰ ì¤‘ì¸ ì‹ì‚¬ (ì¤‘ì‹)" : "ê³§ ë‹¤ê°€ì˜¤ëŠ” ì‹ì‚¬ (ì¤‘ì‹)"});
            targets.push({c: colIdx, r: 4, l: "ë‹¤ìŒ ì‹ì‚¬ (ì„ì‹)"});
        } else if (timeState <= 5) { // ì„ì‹ íƒ€ì„
            targets.push({c: colIdx, r: 4, l: timeState===5 ? "ì§„í–‰ ì¤‘ì¸ ì‹ì‚¬ (ì„ì‹)" : "ê³§ ë‹¤ê°€ì˜¤ëŠ” ì‹ì‚¬ (ì„ì‹)"});
            // ë‚´ì¼ ì¡°ì‹
            let nextCol = colIdx + 1;
            if(nextCol > 7) nextCol = 2; // ê¸ˆìš”ì¼(7) -> ë‹¤ìŒì€? ë°ì´í„° êµ¬ì¡°ìƒ í† (1)ë¡œ ê°ˆì§€ ê³ ë¯¼ í•„ìš”í•˜ë‚˜ ì¼ë‹¨ ìˆœí™˜
            // ì£¼ê°„ ë°ì´í„° ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ í‘œì‹œ ì•ˆí•¨
            if(nextCol <= 7) targets.push({c: nextCol, r: 2, l: "ë‚´ì¼ ì•„ì¹¨ ì‹ì‚¬"});
        } else { // ì„ì‹ í›„
            let nextCol = colIdx + 1;
            if(nextCol <= 7) {
                targets.push({c: nextCol, r: 2, l: "ë‚´ì¼ ì•„ì¹¨ ì‹ì‚¬"});
                targets.push({c: nextCol, r: 3, l: "ë‚´ì¼ ì ì‹¬ ì‹ì‚¬"});
            } else {
                targets.push({c: 0, r: 0, l: "ì´ë²ˆ ì£¼ ì‹ì‚¬ ì¢…ë£Œ", msg: "ë‹¤ìŒ ì£¼ ë©”ë‰´ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!"});
            }
        }

        targets.forEach(t => {
            if(t.c === 0) {
                container.innerHTML += `<div class="card"><div class="meal-title">${t.l}</div><div class="meal-menu">${t.msg}</div></div>`;
                return;
            }
            const dateStr = globalMenuData[0][t.c] + " (" + globalMenuData[1][t.c] + ")";
            const menuStr = globalMenuData[t.r][t.c] || "ë©”ë‰´ ì—†ìŒ";
            
            container.innerHTML += `
                <div class="card">
                    <div class="meal-header">
                        <span class="meal-title">${t.l}</span>
                        <span class="meal-date">${dateStr}</span>
                    </div>
                    <div class="meal-menu">${menuStr}</div>
                </div>`;
        });
    }

    // [íƒ­ 2] ì£¼ê°„ ë©”ë‰´ í…Œì´ë¸” ë Œë”ë§ (ì‰¼í‘œ -> ì¤„ë°”ê¿ˆ ë³€í™˜ ì ìš©)
    function renderWeeklyTable() {
        const table = document.getElementById('weekly-table');
        let html = '';

        globalMenuData.forEach((row, rIdx) => {
            html += '<tr>';
            row.forEach((cell, cIdx) => {
                // í—¤ë”(th)ì¸ì§€ ë°ì´í„°(td)ì¸ì§€ êµ¬ë¶„
                // 0ë²ˆì§¸ ì—´(êµ¬ë¶„), 0ë²ˆì§¸ í–‰(ë‚ ì§œ), 1ë²ˆì§¸ í–‰(ìš”ì¼)ì€ í—¤ë”
                const isHeader = (cIdx === 0 || rIdx <= 1);
                const tag = isHeader ? 'th' : 'td';
                
                let content = cell;

                // ë°ì´í„° ì…€(td)ì¸ ê²½ìš°ì—ë§Œ ì‰¼í‘œ(,)ë¥¼ ì¤„ë°”ê¿ˆ(<br>)ìœ¼ë¡œ ë³€ê²½
                if (!isHeader && content) {
                    // ì •ê·œì‹ ì„¤ëª…: ì‰¼í‘œ(,) ë’¤ì— ê³µë°±ì´ ìˆë“  ì—†ë“  ì‹¹ ë‹¤ ì¡ì•„ì„œ <br>ë¡œ ë°”ê¿ˆ
                    content = content.replace(/,\s*/g, '<br>');
                }

                html += `<${tag}>${content}</${tag}>`;
            });
            html += '</tr>';
        });
        table.innerHTML = html;
    }

    // --- 3. ê´€ë¦¬ì ê¸°ëŠ¥ ---
    function showUploadForm() {
        const pw = document.getElementById('admin-pw').value;
        if(pw) { // í”„ë¡ íŠ¸ì—ì„œëŠ” ê°’ ì¡´ì¬ ì—¬ë¶€ë§Œ ì²´í¬í•˜ê³  ì‹¤ì œ ê²€ì¦ì€ ì„œë²„ê°€ í•¨
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('upload-form').style.display = 'block';
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        }
    }

    function autoFillDates() {
        const picker = document.getElementById('start-date-picker');
        if(!picker.value) return alert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');

        let dateObj = new Date(picker.value);
        if(dateObj.getDay() !== 6) {
            if(!confirm('ì„ íƒí•œ ë‚ ì§œê°€ í† ìš”ì¼ì´ ì•„ë‹™ë‹ˆë‹¤. ì§„í–‰í• ê¹Œìš”?')) return;
        }

        const inputs = document.querySelectorAll('.date-cell');
        inputs.forEach(input => {
            const m = (dateObj.getMonth()+1).toString().padStart(2,'0');
            const d = dateObj.getDate().toString().padStart(2,'0');
            input.value = `${m}ì›”${d}ì¼`;
            dateObj.setDate(dateObj.getDate() + 1);
        });
    }

    function applySmartPaste() {
        const raw = document.getElementById('smart-paste-area').value;
        if(!raw.trim()) return alert("ë¶™ì—¬ë„£ì„ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.");

        const rows = raw.trim().split('\n');
        const targetIds = ['row-bf', 'row-lh', 'row-dn'];
        
        let rCount = 0;
        rows.forEach(rStr => {
            if(rCount >= 3) return;
            const cols = rStr.split('\t');
            const tr = document.getElementById(targetIds[rCount]);
            const textareas = tr.querySelectorAll('textarea');
            
            cols.forEach((val, i) => {
                if(i < 7 && textareas[i]) {
                    textareas[i].value = val.replace(/^"|"$/g, '').trim();
                }
            });
            rCount++;
        });
        alert("í‘œì— ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”.");
    }

    function uploadMenuData() {
        // ë°ì´í„° ìˆ˜ì§‘ (5í–‰ 8ì—´)
        const trs = document.querySelectorAll('#edit-table tr');
        let menuData = [];
        const headers = ["(ê³µë€)", "(ê³µë€)", "ì¡°ì‹", "ì¤‘ì‹", "ì„ì‹"]; // 1ì—´ ë¼ë²¨

        trs.forEach((tr, i) => {
            let row = [headers[i]]; // 1ì—´ì€ ìë™ìƒì„±
            tr.querySelectorAll('.cell-input').forEach(inp => row.push(inp.value));
            menuData.push(row);
        });

        const password = document.getElementById('admin-pw').value;

        if(!confirm('ì •ë§ ì—…ë¡œë“œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

        // [ë³´ì•ˆ] ë¹„ë°€ë²ˆí˜¸ì™€ ë°ì´í„°ë¥¼ í•¨ê»˜ ì „ì†¡
        fetch(SCRIPT_URL, {
    method: 'POST',
    redirect: "follow",    // ì¤‘ìš”: êµ¬ê¸€ì˜ ë¦¬ë””ë ‰ì…˜ì„ ë”°ë¼ê°€ë¼
    headers: {
        "Content-Type": "text/plain;charset=utf-8", // ì¤‘ìš”: JSONì´ë¼ê³  í•˜ë©´ ì°¨ë‹¨ë‹¹í•¨. í…ìŠ¤íŠ¸ë¼ê³  ë»¥ì„ ì³ì•¼ í•¨.
    },
    body: JSON.stringify({ password: password, menuData: menuData })
})
        .then(res => res.json())
        .then(data => {
            if(data.result === 'success') {
                alert('âœ… ì—…ë¡œë“œ ì„±ê³µ!');
                location.reload();
            } else {
                alert('âŒ ì‹¤íŒ¨: ' + data.message); // ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼ ë“±
                if(data.message.includes('ë¹„ë°€ë²ˆí˜¸')) {
                    location.reload(); // ë¹„ë²ˆ í‹€ë¦¬ë©´ ìƒˆë¡œê³ ì¹¨
                }
            }
        })
        .catch(err => alert('í†µì‹  ì˜¤ë¥˜ ë°œìƒ: ' + err));
    }

    // --- 4. ê¸°íƒ€ ìœ í‹¸ ---
    function switchTab(id) {
        document.querySelectorAll('.content').forEach(e => e.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(e => e.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.target.classList.add('active');
    }

    function toggleTheme() {
        const isDark = document.body.getAttribute('data-theme') === 'dark';
        document.body.setAttribute('data-theme', isDark ? 'light' : 'dark');
        localStorage.setItem('theme', isDark ? 'light' : 'dark');
    }

    function applyTheme() {
        const saved = localStorage.getItem('theme');
        if (saved) document.body.setAttribute('data-theme', saved);
    }
</script>
</body>
</html>



